<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini ERP â€” Vendas e Estoque</title>
    <style>
        body {
            font-family: "Segoe UI", sans-serif;
            background-color: #f5f7fb;
            color: #333;
            max-width: 700px;
            margin: 40px auto;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        h1 { text-align: center; color: #3a6ee8; }
        section { margin-bottom: 40px; }
        input, button {
            padding: 8px;
            margin: 5px 0;
            width: 100%;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 15px;
        }
        button {
            background-color: #3a6ee8;
            color: white;
            cursor: pointer;
            transition: 0.3s;
        }
        button:hover { background-color: #345ccc; }
        .result {
            background: #eef3ff;
            border-left: 4px solid #3a6ee8;
            padding: 10px;
            white-space: pre-wrap;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1><header style="text-align:center; margin-bottom:30px;">
    <h1 style="color:#3a6ee8; margin-bottom:5px;">ðŸ’¼ Mini ERP â€” Vendas e Estoque</h1>
    <p style="color:#555; font-size:16px;">Projeto de Desafio â€” <strong>Make More</strong></p>
    <hr style="border:none; border-top:2px solid #3a6ee8; width:60px; margin:15px auto;">
    </header>
    </h1>

    <section>
        <h2>ðŸ“¦ Ajustar Estoque</h2>
        <input type="number" id="adj_prod" placeholder="ID do Produto">
        <input type="number" id="adj_qtd" placeholder="Ajuste de Quantidade">
        <input type="text" id="adj_reason" placeholder="Motivo">
        <button onclick="adjustStock()">Enviar Ajuste</button>
    </section>

    <section>
        <h2>ðŸ§¾ Consultar Estoque</h2>
        <input type="number" id="stock_id" placeholder="ID do Produto">
        <button onclick="getStock()">Ver Estoque</button>
    </section>

    <section>
        <h2>ðŸ›’ Registrar Venda</h2>
        <input type="text" id="sale_id" placeholder="ID da Venda (ex: VND-20251010-001)">
        <input type="number" id="prod_id" placeholder="ID do Produto">
        <input type="number" id="qty" placeholder="Quantidade">
        <input type="number" id="price" placeholder="PreÃ§o">
        <button onclick="registerSale()">Registrar Venda</button>
    </section>

    <div class="result" id="result"></div>

    <script>
        async function adjustStock() {
            const body = {
                product_id: Number(document.getElementById('adj_prod').value),
                adjustment: Number(document.getElementById('adj_qtd').value),
                reason: document.getElementById('adj_reason').value
            };
            const res = await fetch("/stock/adjust", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify(body)
            });
            document.getElementById("result").innerText = JSON.stringify(await res.json(), null, 2);
        }

        async function getStock() {
            const id = document.getElementById("stock_id").value;
            const res = await fetch(`/stock/${id}`);
            document.getElementById("result").innerText = JSON.stringify(await res.json(), null, 2);
        }

        async function registerSale() {
            const body = {
                sale_id: document.getElementById("sale_id").value,
                timestamp: new Date().toISOString(),
                items: [{
                    sku: "P123",
                    product_id: Number(document.getElementById("prod_id").value),
                    quantity: Number(document.getElementById("qty").value),
                    price: Number(document.getElementById("price").value)
                }]
            };
            const res = await fetch("/sales", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify(body)
            });
            document.getElementById("result").innerText = JSON.stringify(await res.json(), null, 2);
        }
    </script>
</body>
</html>
